Криптография
============

В этом разделе мы рассмотрим следующие аспекты безопастности: 

- Генерирование случайных данных
- Шифрование и дешифрование
- Подтверждение целостности данных

Генерирование псевдослучайных данных
----------------------------

Псевдослучайные данные полезны во многих ситуациях. Например, при сбросе пароля по электронной почте вам необходимо сгенерировать
токен, сохранить его в базе данных и отправить его по электронной почте конечному пользователю, который, в свою очередь, позволит им подтвердить право собственности на
этот счет. Очень важно, чтобы этот токен был уникальным и сложноугадываемым, иначе есть вероятность, что злоумышленник
может предсказать значение токена и сбросить пароль пользователя.

Yii security helper упрощает генерацию псевдослучайных чисел данных.


```php
$key = Yii::$app->getSecurity()->generateRandomString();
```

Шифрование и дешифрование
-------------------------

Yii предоставляет удобные вспомогательные функции, которые позволяют шифровать / дешифровать данные с помощью секретного ключа. Данные передаются через функцию шифрования, так что только человек, у которого есть секретный ключ, сможет расшифровать его.
Например, нам нужно сохранить некоторую информацию в нашей базе данных, но мы должны убедиться, что только пользователь, у которого есть секретный ключ, может его просмотреть (даже если база данных приложения скомпрометирована):


```php
// $data and $secretKey получаем из формы
$encryptedData = Yii::$app->getSecurity()->encryptByPassword($data, $secretKey);
// сохраняем $encryptedData в базу данных
```

Впоследствии, когда пользователь хочет прочитать данные:

```php
// $secretKey получаем из пользовательского ввода, $encryptedData из базы данных
$data = Yii::$app->getSecurity()->decryptByPassword($encryptedData, $secretKey);
```

Также возможно использовать ключ вместо пароля через [[\yii\base\Security::encryptByKey()]] и
[[\yii\base\Security::decryptByKey()]].

Подтверждение целостности данных
-------------------------

Существуют ситуации, в которых вам необходимо проверить, что ваши данные не были подделаны третьей стороной или даже повреждены каким-либо образом. Yii обеспечивает простой способ подтверждения целостности данных в виде двух вспомогательных функций.

Префикс данных с хешем, сгенерированным из секретного ключа и данных


```php
// $secretKey нашего приложения или пользовательский секрет, $genuineData получен из надежного источника
$data = Yii::$app->getSecurity()->hashData($genuineData, $secretKey);
```

Проверяет, была ли нарушена целостность данных

```php
// $secretKey нашего приложения или пользовательский секрет, $data получена из ненадежного источника
$data = Yii::$app->getSecurity()->validateData($data, $secretKey);
```
